// This file is part of the "jQuery.Syntax" project, and is distributed under the MIT License.
// Copyright (c) 2011 Samuel G. D. Williams. <http://www.oriontransfer.co.nz>

Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice.call(arguments,1),c=this;return function(){return c.apply(a,b)}});function ResourceLoader(a){this.dependencies={};this.loading={};this.loader=a}ResourceLoader.prototype._finish=function(a){var b=this.dependencies[a];if(b){a=this._loaded.bind(this,a);for(var c=0;c<b.length;c+=1)a=this.get.bind(this,b[c],a);a()}else this._loaded(a)};
ResourceLoader.prototype._loaded=function(a){var b=this[a],c=this.loading[a];this.loading[a]=null;if(b)for(a=0;a<c.length;a+=1)c[a](b);else alert("ResourceLoader: Could not load resource named "+a)};ResourceLoader.prototype.dependency=function(a,b){if(!this[b]||this.loading[name])this.dependencies[a]?this.dependencies[a].push(b):this.dependencies[a]=[b]};
ResourceLoader.prototype.get=function(a,b){this.loading[a]?this.loading[a].push(b):this[a]?b(this[a]):(this.loading[a]=[b],this.loader(a,this._finish.bind(this,a)))};
var Syntax={root:null,aliases:{},styles:{},themes:{},lib:{},defaultOptions:{cacheScripts:!0,cacheStyleSheets:!0,theme:"base"},brushes:new ResourceLoader(function(a,b){a=Syntax.aliases[a]||a;Syntax.getResource("jquery.syntax.brush",a,b)}),layouts:new ResourceLoader(function(a,b){Syntax.getResource("jquery.syntax.layout",a,b)}),loader:new ResourceLoader(function(a,b){Syntax.getResource("jquery.syntax",a,b)}),getStyles:function(a){var b=jQuery("<link>");jQuery("head").append(b);Syntax.defaultOptions.cacheStyleSheets||
(a=a+"?"+Math.random());b.attr({rel:"stylesheet",type:"text/css",href:a})},getScript:function(a,b){var c=document.createElement("script");c.onreadystatechange=function(){if(this.onload&&("loaded"==this.readyState||"complete"==this.readyState))this.onload(),this.onload=null};c.onload=b;c.type="text/javascript";Syntax.defaultOptions.cacheScripts||(a=a+"?"+Math.random());c.src=a;document.getElementsByTagName("head")[0].appendChild(c)},getResource:function(a,b,c){a=a+"."+b;if(b=this.styles[a])for(var d=
0;d<b.length;d+=1)this.getStyles(this.root+b[d]);Syntax.getScript(this.root+a+".js",c)},alias:function(a,b){Syntax.aliases[a]=a;for(var c=0;c<b.length;c+=1)Syntax.aliases[b[c]]=a},brushAliases:function(a){var b=[],c;for(c in Syntax.aliases)Syntax.aliases[c]===a&&b.push(c);return b},brushNames:function(){var a=[],b;for(b in Syntax.aliases)b===Syntax.aliases[b]&&a.push(b);return a},extractBrushName:function(a){a=a.toLowerCase();var b=a.match(/brush-([\S]+)/);if(b)return b[1];a=a.split(/ /);if(-1!==
jQuery.inArray("syntax",a))for(b=0;b<a.length;b+=1){var c=Syntax.aliases[a[b]];if(c)return c}return null},detectRoot:function(){if(null==Syntax.root){var a=jQuery("script").filter(function(){return this.src.match(/jquery\.syntax/)}).get(0);if(a&&(a=a.src.match(/.*\//)))Syntax.root=a[0]}},log:function(){"undefined"!=typeof console&&console.log?console.log.apply(console,arguments):window.console&&window.console.log&&window.console.log.apply(window.console,arguments)}};
jQuery.fn.syntax=function(a,b){Syntax.detectRoot();var c=this;Syntax.loader.get("core",function(){Syntax.highlight(c,a,b)})};
jQuery.syntax=function(a,b){a=a||{};var c=a.context;a.root?Syntax.root=a.root:Syntax.detectRoot();a=jQuery.extend(Syntax.defaultOptions,a);a.blockSelector=a.blockSelector||"pre.syntax:not(.highlighted)";a.inlineSelector=a.inlineSelector||"code.syntax:not(.highlighted)";a.blockLayout=a.blockLayout||"list";a.inlineLayout=a.inlineLayout||"inline";"undefined"==typeof a.replace&&(a.replace=!0);jQuery(a.blockSelector,c).each(function(){jQuery(this).syntax(jQuery.extend({},a,{brush:Syntax.extractBrushName(this.className),
layout:a.blockLayout}),b)});jQuery(a.inlineSelector,c).each(function(){jQuery(this).syntax(jQuery.extend({},a,{brush:Syntax.extractBrushName(this.className),layout:a.inlineLayout}),b)})};Syntax.alias("apache",[]);Syntax.alias("applescript",[]);Syntax.alias("assembly",["asm"]);Syntax.alias("bash-script",[]);Syntax.alias("bash",[]);Syntax.alias("basic",["vb"]);Syntax.alias("clang",["cpp","c++","c","objective-c"]);Syntax.alias("csharp",["c-sharp","c#"]);Syntax.alias("css",[]);Syntax.alias("diff",["patch"]);
Syntax.alias("go",[]);Syntax.alias("haskell",[]);Syntax.alias("html",[]);Syntax.alias("io",[]);Syntax.alias("java",[]);Syntax.alias("javascript",["js","actionscript"]);Syntax.alias("kai",[]);Syntax.alias("lisp",["scheme","clojure"]);Syntax.alias("lua",[]);Syntax.alias("ocaml",["ml","sml","fsharp"]);Syntax.alias("ooc",[]);Syntax.alias("pascal",["delphi"]);Syntax.alias("perl5",[]);Syntax.alias("php-script",[]);Syntax.alias("php",[]);Syntax.alias("plain",["text"]);Syntax.alias("protobuf",[]);
Syntax.alias("python",[]);Syntax.alias("ruby",[]);Syntax.alias("scala",[]);Syntax.alias("smalltalk",[]);Syntax.alias("sql",[]);Syntax.alias("super-collider",["sc"]);Syntax.alias("xml",[]);Syntax.alias("yaml",[]);Syntax.styles["jquery.syntax.brush.apache"]=["base/jquery.syntax.brush.apache.css"];Syntax.styles["jquery.syntax.brush.applescript"]=["base/jquery.syntax.brush.applescript.css"];Syntax.styles["jquery.syntax.brush.assembly"]=["base/jquery.syntax.brush.assembly.css"];
Syntax.styles["jquery.syntax.brush.bash-script"]=["base/jquery.syntax.brush.bash-script.css"];Syntax.styles["jquery.syntax.brush.bash"]=["base/jquery.syntax.brush.bash.css"];Syntax.styles["jquery.syntax.brush.clang"]=["base/jquery.syntax.brush.clang.css"];Syntax.styles["jquery.syntax.brush.css"]=["base/jquery.syntax.brush.css.css"];Syntax.styles["jquery.syntax.brush.diff"]=["base/jquery.syntax.brush.diff.css"];Syntax.styles["jquery.syntax.brush.html"]=["base/jquery.syntax.brush.html.css"];
Syntax.styles["jquery.syntax.brush.ocaml"]=["base/jquery.syntax.brush.ocaml.css"];Syntax.styles["jquery.syntax.brush.protobuf"]=["base/jquery.syntax.brush.protobuf.css"];Syntax.styles["jquery.syntax.brush.python"]=["base/jquery.syntax.brush.python.css"];Syntax.styles["jquery.syntax.brush.ruby"]=["base/jquery.syntax.brush.ruby.css"];Syntax.styles["jquery.syntax.brush.xml"]=["base/jquery.syntax.brush.xml.css"];
Syntax.styles["jquery.syntax.core"]=["base/jquery.syntax.core.css","bright/jquery.syntax.core.css","paper/jquery.syntax.core.css"];Syntax.styles["jquery.syntax.layout.editor"]=["base/jquery.syntax.layout.editor.css","grey/jquery.syntax.layout.editor.css","modern/jquery.syntax.layout.editor.css"];Syntax.styles["jquery.syntax.layout.fixed"]=["base/jquery.syntax.layout.fixed.css","grey/jquery.syntax.layout.fixed.css","modern/jquery.syntax.layout.fixed.css","paper/jquery.syntax.layout.fixed.css"];
Syntax.styles["jquery.syntax.layout.list"]=["base/jquery.syntax.layout.list.css","grey/jquery.syntax.layout.list.css"];Syntax.styles["jquery.syntax.layout.plain"]=["base/jquery.syntax.layout.plain.css","grey/jquery.syntax.layout.plain.css","modern/jquery.syntax.layout.plain.css"];Syntax.styles["jquery.syntax.layout.table"]=["base/jquery.syntax.layout.table.css","grey/jquery.syntax.layout.table.css"];
Syntax.styles["jquery.syntax.layout.inline"]=["grey/jquery.syntax.layout.inline.css","modern/jquery.syntax.layout.inline.css","paper/jquery.syntax.layout.inline.css"];Syntax.themes.base=[];Syntax.themes.bright=["grey","base"];Syntax.themes.grey=["base"];Syntax.themes.modern=["base"];Syntax.themes.paper=["base"];
